---
title: Созданные значения — EF Core
author: rowanmiller
ms.date: 10/27/2016
ms.assetid: eb082011-11a1-41b4-a108-15daafa03e80
uid: core/modeling/generated-properties
ms.openlocfilehash: 9ecfa924a0614f327f0bd202cb7dda95bea810af
ms.sourcegitcommit: 0d36e8ff0892b7f034b765b15e041f375f88579a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2018
ms.locfileid: "44250703"
---
# <a name="generated-values"></a>Генерируемые значения

## <a name="value-generation-patterns"></a>Шаблоны для генерируемых значений

Существует три шаблона создания генерируемых значений, которые могут использоваться для свойств.
* Без генерации значения
* Значение, генерируемое при добавлении
* Значение, генерируемое при добавлении или обновлении

### <a name="no-value-generation"></a>Без генерации значения

Без генерации значения означает, что необходимо всегда указывать допустимое значение, которое будет сохранено в базе данных. Допустимое значение должно быть присвоено новым сущностям до того, как они будут добавлены в контекст.

### <a name="value-generated-on-add"></a>Значение, генерируемое при добавлении

Значение, генерируемое при добавлении означает, что значение будет сгенерировано для новых сущностей.

В зависимости от используемого поставщика базы данных, значение может генерироваться как на клиентское стороне с помощью EF, так и на стороне базы данных. Если значение генерируется средствами базы данных, EF может присвоить временное значение при добавлении сущности в контекст. Затем временное значение может быть заменено на значение, сгенерированное базой данных, во время вызова `SaveChanges()`.

При добавлении сущности в контекст, которая имеет значение, присвоенное свойству, EF пытается вставить это значение, вместо того чтобы генерировать новое. Считается, что свойству присвоено значение, если ему не установлено значение по умолчанию в среде CLR (`null` для `string`, `0` для `int`, `Guid.Empty` для `Guid`и т. д.). Дополнительные сведения см. в разделе [явные значения для генерируемых свойств](../saving/explicit-values-generated-properties.md).

> [!WARNING]  
> Способ генерации значений при добавлении сущностей будет зависеть от используемого поставщика базы данных. Он может устанавливать автоматическую генерацию значений для некоторых типов свойств, тогда как другие могут требовать явного указания способа генерации значений.
>
> Например, при использовании SQL Server, автоматически будут генерироваться значения для `GUID` свойств (с помощью SQL Server алгоритма последовательной генерации GUID). Однако, если задать генерацию значений при добавлении для свойства с типом `DateTime`, то необходимо указать способ создания значений для генерации. Один из вариантов сделать это - настроить значение по умолчанию для `GETDATE()`, см. в разделе [значения по умолчанию](relational/default-values.md).

### <a name="value-generated-on-add-or-update"></a>Значение, генерируемое при добавлении или обновлении

Значение, генерируемое при добавлении или обновлении означает, что новые значения будут генерироваться каждый раз, когда происходит сохранение записи (вставка или обновление).

Так же как и для значенй, генерируемых при добавлении, если задать свойству значение для вновь добавляемого экземпляра сущности, то будет вставлено это значение, вместо генерируемого. Также возможно задать явное значение при обновлении. Дополнительные сведения см. в разделе [явные значения для генерируемых свойств](../saving/explicit-values-generated-properties.md).

> [!WARNING]
> Способ создания значения для добавленных и измененных сущностей будет зависеть от используемого поставщика базы данных. Поставщики баз данных могут устанавливать атоматическую генерацию значений для некоторых типов свойств, тогда как другие требуют явного указания способа генерации значений.
> 
> Например, при использовании SQL Server, свойства с типом `byte[]`, которым установлена генерация значений при добавлении и обновлении и помеченные токеном параллелизма, будут иметь тип данных `rowversion`, так что значения будут генерироваться в базе данных. Однако, если указать, что значение для свойства с типом `DateTime` генерируется при добавлении или обновлении, то необходимо указать способ генерации значений. Один из вариантов сделать это - настроить значение по умолчанию для `GETDATE()` (см. в разделе [значения по умолчанию](relational/default-values.md)), чтобы генерировать значения для новых строк. Затем можно использовать триггеры базы данных для генерации значений во время обновления (например, как триггер в следующем примере).
> 
> [!code-sql[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedOnAddOrUpdate.sql)]

## <a name="conventions"></a>Соглашения

По соглашению, для несоставных первичных ключей типов short, int, long или Guid будет задана генерация значений при добавлении. Для всех остальных свойств не будет задана генерация значений.

## <a name="data-annotations"></a>Аннотации данных

### <a name="no-value-generation-data-annotations"></a>Без генерации значения (аннотации данных)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/Samples/ValueGeneratedNever.cs#Sample)]

### <a name="value-generated-on-add-data-annotations"></a>Значение, генерируемое при добавлении (аннотации данных)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/Samples/ValueGeneratedOnAdd.cs#Sample)]

> [!WARNING]  
> Здесь просто сообщается EF, что значения генерируются для добавляемых сущностей. Это не гарантирует, что EF будет использовать реальный механизм для генерации значений. Более подробные сведения см. в разделе [Значение, генерируемое при добавлении](#value-generated-on-add).

### <a name="value-generated-on-add-or-update-data-annotations"></a>Значение, генерируемое при добавлении или обновлении (аннотации данных)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/Samples/ValueGeneratedOnAddOrUpdate.cs#Sample)]

> [!WARNING]  
> Здесь просто сообщается EF, что значения генерируются для добавляемых или обновляемых сущностей. Это не гарантирует, что EF будет использовать реальных механизм для генерации значений. Более подробные сведения см. в разделе [Значение, генерируемое при добавлении или обновлении](#value-generated-on-add-or-update).

## <a name="fluent-api"></a>Fluent API

Fluent API можно использовать для изменения шаблона генерации значения для заданного свойства.

### <a name="no-value-generation-fluent-api"></a>Без генерации значения (Fluent API)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedNever.cs#Sample)]

### <a name="value-generated-on-add-fluent-api"></a>Значение, генерируемое при добавлении (Fluent API)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedOnAdd.cs#Sample)]

> [!WARNING]  
> `ValueGeneratedOnAdd()` просто сообщает EF, что значения генерируются для добавляемых сущностей. Это не гарантирует, что EF будет использовать реальный механизм для генерации значений. Более подробные сведения см. в разделе [Значение, генерируемое при добавлении](#value-generated-on-add).

### <a name="value-generated-on-add-or-update-fluent-api"></a>Значение, генерируемое при добавлении или обновлении (Fluent API)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/Samples/ValueGeneratedOnAddOrUpdate.cs#Sample)]

> [!WARNING]  
> Здесь просто сообщается EF, что значения генерируются для добавляемых или обновляемых сущностей. Это не гарантирует, что EF будет использовать реальных механизм для генерации значений. Более подробные сведения см. в разделе [Значение, генерируемое при добавлении или обновлении](#value-generated-on-add-or-update).
